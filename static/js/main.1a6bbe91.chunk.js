(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{53:function(e,t,n){e.exports=n(94)},58:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(45),u=n.n(o),c=(n(58),n(8)),l=n(15),i=n(9),m=n(18),s=n(20),g=n(19),b=n(46),h=n.n(b),p="".concat("https://upgrade-songs.herokuapp.com","/auth"),E=function(e){return"".concat(p).concat(e?"/login":"/register")};var f=function(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],o=t[1],u=Object(a.useState)(""),l=Object(c.a)(u,2),i=l[0],s=l[1],g=Object(a.useState)(!1),b=Object(c.a)(g,2),p=b[0],f=b[1];return r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),n&&i){var t=E(p),a={email:n,password:i};h.a.post(t,a).then(function(e){if(p){var t=e.data.token;m.cookies.authToken=t}else f(!0)}).catch(function(e){console.log(e)})}}},r.a.createElement("button",{type:"button",onClick:function(){return f(!p)}},"Change mode"),r.a.createElement("h2",null,"Authentication - ",p?"Login":"Register"),r.a.createElement("label",null,r.a.createElement("span",null,"Email"),r.a.createElement("input",{type:"text",value:n,onChange:function(e){return o(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("span",null,"Password"),r.a.createElement("input",{type:"password",value:i,onChange:function(e){return s(e.target.value)}})),r.a.createElement("button",{type:"submit"},p?"Login":"Register"))};var v=function(){return r.a.createElement("div",null,r.a.createElement(s.b,{to:"/songs"},"Go to songs"),r.a.createElement(s.b,{to:"/authors"},"Go to authors"),r.a.createElement(s.b,{to:"/create-song"},"Create a song"),r.a.createElement(s.b,{to:"/create-author"},"Create an author"))},d=n(22);function j(){var e=Object(d.a)(["\n  {\n    authors {\n      id\n      name\n      age\n      songs {\n        id\n        name\n      }\n    }\n  }\n"]);return j=function(){return e},e}function O(){var e=Object(d.a)(["\n  {\n    songs {\n      id\n      name\n      genre\n    }\n  }\n"]);return O=function(){return e},e}var y=Object(l.b)(O()),k=Object(l.b)(j());function S(){var e=Object(d.a)(["\n  mutation($name: String!, $age: Int!) {\n    addAuthor(name: $name, age: $age) {\n      id\n      name\n    }\n  }\n"]);return S=function(){return e},e}function C(){var e=Object(d.a)(["\n  mutation($id: ID!) {\n    deleteSong(id: $id) {\n      id\n    }\n  }\n"]);return C=function(){return e},e}function w(){var e=Object(d.a)(["\n  mutation($name: String!, $genre: String!, $year: Int!, $authorId: ID!) {\n    addSong(name: $name, genre: $genre, year: $year, authorId: $authorId) {\n      id\n      name\n    }\n  }\n"]);return w=function(){return e},e}var $=Object(l.b)(w()),I=Object(l.b)(C()),A=Object(l.b)(S());var x=Object(i.b)(Object(i.c)(y,{name:"songsQuery"}),Object(i.c)(I,{name:"deleteSong"}))(function(e){var t=e.songsQuery,n=e.deleteSong,a=e.history,o=t.loading,u=t.songs;return o?r.a.createElement("h1",null,"Fetching songs..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",onClick:function(){return a.push("/")}},"Go back"),r.a.createElement("ul",null,u.map(function(e){var t=e.id,a=e.name,o=e.genre;return r.a.createElement("li",{key:t},r.a.createElement("p",null,"Name: ",a),r.a.createElement("p",null,"Genre: ",o),r.a.createElement("button",{onClick:function(){return n({variables:{id:t},refetchQueries:[{query:y}]})}},"Delete Song"))})))});var Q=Object(i.c)(k)(function(e){var t=e.data,n=e.history,a=t.loading,o=t.authors;return a?r.a.createElement("h1",null,"Fetching authors..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",onClick:function(){return n.push("/")}},"Go back"),r.a.createElement("ul",null,o.map(function(e){var t=e.id,n=e.name,a=e.age,o=e.songs;return r.a.createElement("li",{key:t},r.a.createElement("p",null,"Name: ",n),r.a.createElement("p",null,"Age: ",a),r.a.createElement("p",null,"Songs:"," ",o.map(function(e){var t=e.id,n=e.name;return r.a.createElement("span",{key:t},n)})))})))}),D=["Rock","Pop","Rap","Reggae","Metal","Classic"];var F=Object(i.b)(Object(i.c)(k,{name:"authorsQuery"}),Object(i.c)($,{name:"addSong"}))(function(e){var t=e.history,n=e.authorsQuery,o=e.addSong,u=Object(a.useState)(""),l=Object(c.a)(u,2),i=l[0],m=l[1],s=Object(a.useState)(""),g=Object(c.a)(s,2),b=g[0],h=g[1],p=Object(a.useState)(""),E=Object(c.a)(p,2),f=E[0],v=E[1],d=Object(a.useState)(""),j=Object(c.a)(d,2),O=j[0],y=j[1],S=n.loading,C=n.authors;return S?r.a.createElement("h1",null,"Fetching authors"):r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i&&b&&f&&O&&o({variables:{name:i,year:parseInt(b,10),genre:f,authorId:O},refetchQueries:[{query:k}]}).then(function(){t.push("/songs")}).catch(function(e){return console.log(e)})}},r.a.createElement("label",null,r.a.createElement("span",null,"Song name"),r.a.createElement("input",{type:"text",value:i,onChange:function(e){return m(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("span",null,"Song year"),r.a.createElement("input",{type:"number",value:b,onChange:function(e){return h(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("span",null,"Song genre"),r.a.createElement("select",{value:f,onChange:function(e){return v(e.target.value)}},r.a.createElement("option",{value:""},"Select a genre"),D.map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement("label",null,r.a.createElement("span",null,"Song author"),r.a.createElement("select",{value:O,onChange:function(e){return y(e.target.value)}},r.a.createElement("option",{value:""},"Select an author"),C.map(function(e){var t=e.id,n=e.name;return r.a.createElement("option",{key:t,value:t},n)}))),r.a.createElement("button",{type:"submit"},"Create song"))});var T=Object(i.c)(A,{name:"addAuthor"})(function(e){var t=e.history,n=e.addAuthor,o=Object(a.useState)(""),u=Object(c.a)(o,2),l=u[0],i=u[1],m=Object(a.useState)(""),s=Object(c.a)(m,2),g=s[0],b=s[1];return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),l&&g&&n({variables:{name:l,age:parseInt(g,10)},refetchQueries:[{query:k}]}).then(function(){t.push("/authors")}).catch(function(e){return console.log(e)})}},r.a.createElement("label",null,r.a.createElement("span",null,"Author name"),r.a.createElement("input",{type:"text",value:l,onChange:function(e){return i(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("span",null,"Author age"),r.a.createElement("input",{type:"number",value:g,onChange:function(e){return b(e.target.value)}})),r.a.createElement("button",{type:"submit"},"Create author"))});n(93);var G=function(e){var t=!!e.authToken,n=Object(a.useState)(t),o=Object(c.a)(n,2),u=o[0],l=o[1];return Object(a.useEffect)(function(){t&&!u&&l(!0),!t&&u&&l(!1)},[t,u]),r.a.createElement(s.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Im working"),u&&r.a.createElement("button",{type:"button",onClick:function(){delete m.cookies.authToken}},"Logout"),r.a.createElement(g.c,null,u?r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{exact:!0,path:"/songs",component:x}),r.a.createElement(g.a,{exact:!0,path:"/authors",component:Q}),r.a.createElement(g.a,{exact:!0,path:"/create-song",component:F}),r.a.createElement(g.a,{exact:!0,path:"/create-author",component:T}),r.a.createElement(g.a,{path:"/",component:v})):r.a.createElement(g.a,{path:"/",component:f}))))},R="https://upgrade-songs.herokuapp.com";var q=function(e){e.children;var t=m.cookies.authToken,n=Object(a.useState)(t),o=Object(c.a)(n,2),u=o[0],s=o[1],g=new l.a({uri:"".concat(R,"/graphql"),headers:{Authorization:t}});return Object(m.subscribe)(m.cookies,"authToken",function(e){s(e)}),r.a.createElement(i.a,{client:g},r.a.createElement(G,{authToken:u}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[53,1,2]]]);
//# sourceMappingURL=main.1a6bbe91.chunk.js.map